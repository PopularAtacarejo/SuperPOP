<!DOCTYPE html>
<html lang="pt-BR"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>SuperPop | Meus Super POP's</title>
<link href="https://i.ibb.co/99R7YqxF/Icon.png" rel="icon" type="image/png"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script>
  tailwind.config = {
    darkMode: "class",
    theme: {
      extend: {
        colors: {
          primary: "#E63946",
          secondary: "#FFB703",
          "surface-dark": "#2D282A",
        },
        fontFamily: {
          display: ["Fredoka One", "cursive"],
          body: ["Nunito", "sans-serif"],
        },
        boxShadow: {
          soft: "0 8px 30px -4px rgba(0, 0, 0, 0.08)",
          card: "0 15px 40px -10px rgba(0, 0, 0, 0.12)",
        },
      },
    },
  };
</script>
<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&amp;family=Nunito:wght@400;600;700;800&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<style>
  .bg-pattern {
    background-color: #ffffff;
    background-image: radial-gradient(#E63946 0.5px, transparent 0.5px), radial-gradient(#FFB703 0.5px, #ffffff 0.5px);
    background-size: 20px 20px;
    background-position: 0 0, 10px 10px;
    opacity: 0.4;
    position: fixed;
    inset: 0;
    z-index: -1;
    pointer-events: none;
  }
  .sidebar {
    transition: width 0.4s cubic-bezier(0.25, 1, 0.5, 1);
    width: 72px;
    display: flex;
    flex-direction: column;
  }
  .sidebar.expanded {
    width: 250px;
  }
  .sidebar.expanded .sidebar-header {
    padding-left: 0.75rem;
    padding-right: 0.75rem;
  }
  .sidebar-header {
    padding-left: 1.5rem;
    padding-right: 1.5rem;
    transition: padding 0.25s ease;
  }
  .sidebar-nav {
    transition: padding 0.25s ease;
    padding-top: 0.5rem;
  }
  .menu-section-title {
    font-size: 0.72rem;
    line-height: 1rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    font-weight: 800;
    color: #ef4444;
  }
  .menu-item {
    position: relative;
    display: flex;
    align-items: center;
    min-height: 44px;
    padding: 0 0.75rem;
    border-radius: 12px;
    color: #64748b;
    font-weight: 700;
    transition: background-color 0.2s ease, color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
  }
  .menu-item .material-symbols-outlined {
    font-size: 22px;
    width: 36px;
    height: 36px;
    line-height: 1;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: 999px;
    background: #eef2f7;
    color: #475569;
    border: 1px solid rgba(148, 163, 184, 0.28);
    font-variation-settings: "FILL" 0, "wght" 600, "GRAD" 0, "opsz" 24;
    transition: transform 0.2s ease, background-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
  }
  .menu-item-label {
    font-size: 0.98rem;
    letter-spacing: 0.01em;
  }
  .menu-item:hover {
    background: #fff1f2;
    color: #9f1239;
    transform: translateX(2px);
  }
  .menu-item:hover .material-symbols-outlined {
    transform: scale(1.06);
    background: #ffe4e6;
    color: #be123c;
    border-color: rgba(230, 57, 70, 0.28);
    box-shadow: 0 4px 10px rgba(230, 57, 70, 0.16);
  }
  .menu-item.active {
    background: #fee2e2;
    color: #b91c1c;
    box-shadow: inset 0 0 0 1px rgba(239, 68, 68, 0.28), 0 6px 14px rgba(230, 57, 70, 0.1);
  }
  .menu-item.active .material-symbols-outlined {
    background: linear-gradient(145deg, #ef4444, #dc2626);
    border-color: rgba(255, 255, 255, 0.65);
    color: #ffffff;
    font-variation-settings: "FILL" 1, "wght" 700, "GRAD" 0, "opsz" 24;
    box-shadow: 0 8px 16px rgba(220, 38, 38, 0.34);
  }
  .sidebar-content-fade {
    opacity: 0;
    transform: translateX(-10px);
    transition: opacity 0.2s ease, transform 0.2s ease;
    pointer-events: none;
    position: absolute;
    visibility: hidden;
  }
  .sidebar.expanded .sidebar-content-fade {
    opacity: 1;
    transform: translateX(0);
    pointer-events: auto;
    position: static;
    visibility: visible;
  }
  .main-content {
    margin-left: 72px;
    transition: margin-left 0.4s cubic-bezier(0.25, 1, 0.5, 1);
  }
  .sidebar.expanded ~ .main-content {
    margin-left: 250px;
  }
  .sidebar:not(.expanded) .sidebar-header {
    padding-left: 0.75rem;
    padding-right: 0.75rem;
  }
  .sidebar:not(.expanded) .sidebar-nav {
    padding-left: 0.5rem;
    padding-right: 0.5rem;
  }
  .sidebar:not(.expanded) .menu-item {
    justify-content: center;
    width: 44px;
    min-height: 44px;
    padding: 0;
    margin-left: auto;
    margin-right: auto;
  }
  .sidebar:not(.expanded) .menu-item:hover {
    transform: none;
  }
  @media (max-width: 768px) {
    .sidebar {
      width: 0;
      overflow: hidden;
      position: fixed;
      z-index: 50;
      height: 100vh;
    }
    .sidebar.expanded {
      width: 250px;
    }
    .main-content {
      margin-left: 0 !important;
    }
    .sidebar-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 40;
      backdrop-filter: blur(2px);
    }
    .sidebar.expanded + .sidebar-overlay {
      display: block;
    }
  }
  .auth-user-menu {
    position: fixed;
    top: 14px;
    right: 14px;
    z-index: 45;
  }
  .auth-user-btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    border: 1px solid rgba(226, 232, 240, 0.9);
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(6px);
    border-radius: 999px;
    padding: 6px 10px;
    color: #0f172a;
    box-shadow: 0 8px 20px rgba(15, 23, 42, 0.12);
    cursor: pointer;
  }
  .auth-user-btn .material-symbols-outlined {
    font-size: 20px;
  }
  .auth-user-btn-text strong {
    max-width: 160px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    font-size: 0.77rem;
    display: block;
  }
  .auth-user-btn-text small {
    max-width: 160px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    color: #64748b;
    font-size: 0.68rem;
    font-weight: 700;
    display: block;
  }
  .auth-user-dropdown {
    display: none;
    position: absolute;
    top: calc(100% + 8px);
    right: 0;
    width: min(280px, 88vw);
    background: #ffffff;
    border: 1px solid #e2e8f0;
    border-radius: 14px;
    box-shadow: 0 16px 36px rgba(15, 23, 42, 0.18);
    padding: 12px;
  }
  .auth-user-dropdown.open {
    display: block;
  }
</style>
</head>
<body class="bg-gray-50 text-gray-900 font-body antialiased min-h-screen flex flex-col">
<div class="bg-pattern"></div>
<aside class="sidebar fixed top-0 left-0 h-screen bg-white shadow-xl z-50 border-r border-gray-100" id="sidebar">
<div class="sidebar-header pt-6 pb-2 px-6 flex flex-col gap-4">
<div class="h-24 flex items-center justify-center overflow-hidden relative">
<div class="absolute left-0 transition-opacity duration-300 w-12 h-12 flex items-center justify-center">
<img alt="SP" class="w-10 h-10 object-contain opacity-100 sidebar-collapsed-only" src="https://i.ibb.co/99R7YqxF/Icon.png"/>
</div>
<div class="sidebar-content-fade w-full px-1">
<img alt="SuperPop Logo" class="object-contain w-full h-auto max-h-[84px]" src="https://i.ibb.co/VpLWwfNB/Gemini-Generated-Image-1aiacj1aiacj1aia.png"/>
</div>
</div>
</div>
<nav class="sidebar-nav flex-1 overflow-y-auto px-3 py-2 space-y-6">
<div class="space-y-1">
<div class="px-3 mb-2 sidebar-content-fade">
<span class="menu-section-title">Geral</span>
</div>
<a class="menu-item group" href="superpop.html">
<span class="material-symbols-outlined shrink-0">send</span>
<span class="menu-item-label ml-3 sidebar-content-fade whitespace-nowrap">Enviar Super POP!</span>
</a>
<a class="menu-item active group" href="meus-superpops.html">
<span class="material-symbols-outlined shrink-0">history</span>
<span class="menu-item-label ml-3 sidebar-content-fade whitespace-nowrap">Meus Super POP's</span>
</a>
<a class="menu-item group" href="rank.html">
<span class="material-symbols-outlined shrink-0">leaderboard</span>
<span class="menu-item-label ml-3 sidebar-content-fade whitespace-nowrap">Ranking</span>
</a>
<a class="menu-item group" href="ganhadores.html">
<span class="material-symbols-outlined shrink-0">workspace_premium</span>
<span class="menu-item-label ml-3 sidebar-content-fade whitespace-nowrap">Ganhadores do Mês</span>
</a>
</div>
</nav>
<button class="absolute -right-3 top-12 bg-white text-gray-400 hover:text-primary border border-gray-200 rounded-full p-1 shadow-md hover:scale-110 transition-all hidden md:flex items-center justify-center w-6 h-6 z-50" id="sidebarToggle" type="button">
<span class="material-symbols-outlined text-[14px]">chevron_right</span>
</button>
</aside>
<div class="sidebar-overlay" id="sidebarOverlay"></div>
<button class="md:hidden fixed top-4 left-4 z-40 bg-white p-2 rounded-lg shadow-soft text-gray-600 border border-gray-100" id="mobileMenuBtn" type="button">
<span class="material-symbols-outlined">menu</span>
</button>
<div class="auth-user-menu" id="authUserMenu">
<button aria-expanded="false" class="auth-user-btn" id="authUserBtn" type="button">
<span class="material-symbols-outlined">account_circle</span>
<span class="auth-user-btn-text">
<strong id="authUserName">Carregando...</strong>
<small id="authUserRole">Perfil</small>
</span>
<span class="material-symbols-outlined">expand_more</span>
</button>
<div class="auth-user-dropdown" id="authUserDropdown">
<p class="text-sm font-bold text-gray-900" id="authUserNameDetail">Carregando...</p>
<p class="text-xs font-semibold text-gray-500 mb-3" id="authUserRoleDetail">Perfil</p>
<button class="w-full rounded-xl bg-red-100 text-red-700 text-sm font-bold py-2 hover:bg-red-200 transition-colors" id="authLogoutBtn" type="button">Sair</button>
</div>
</div>
<div class="main-content flex-col flex min-h-screen">
<header class="relative px-6 pb-2 pt-4 text-center">
<div class="max-w-7xl mx-auto relative z-10 pt-4">
<img alt="SuperPop" class="mx-auto w-48 sm:w-72 h-auto" src="https://i.ibb.co/VpLWwfNB/Gemini-Generated-Image-1aiacj1aiacj1aia.png"/>
</div>
</header>
<main class="flex-1 max-w-7xl mx-auto w-full px-5 py-6 space-y-6">
<section class="text-center space-y-2">
<h1 class="font-display text-4xl sm:text-5xl text-primary uppercase tracking-tight">Meus Super POP's</h1>
<p class="text-gray-600 font-semibold text-base sm:text-lg">Veja os Super POP's que você enviou e recebeu no mês atual, com histórico de meses anteriores.</p>
</section>

<section class="bg-white/95 border border-white/70 rounded-2xl shadow-card p-4 sm:p-5">
<div class="flex flex-col sm:flex-row gap-3 sm:items-end sm:justify-between">
<div class="w-full sm:max-w-sm">
<label class="block text-xs font-bold uppercase tracking-wide text-primary mb-1.5" for="monthSelect">Mês</label>
<select class="w-full rounded-xl border-gray-200 bg-gray-50 focus:ring-primary focus:border-primary font-semibold text-gray-800" id="monthSelect"></select>
</div>
<button class="inline-flex items-center justify-center gap-2 rounded-xl bg-primary text-white font-bold px-4 py-2.5 hover:bg-red-700 transition-colors disabled:opacity-70 disabled:cursor-not-allowed" id="refreshBtn" type="button">
<span class="material-symbols-outlined text-base">refresh</span>
<span id="refreshBtnLabel">Atualizar</span>
</button>
</div>
</section>

<section class="grid grid-cols-1 sm:grid-cols-3 gap-4">
<article class="bg-white/95 border border-white/70 rounded-2xl shadow-soft p-4">
<p class="text-xs font-bold uppercase tracking-wide text-primary">Total no mês</p>
<p class="mt-2 text-3xl font-display text-gray-900" id="totalMes">0</p>
</article>
<article class="bg-white/95 border border-white/70 rounded-2xl shadow-soft p-4">
<p class="text-xs font-bold uppercase tracking-wide text-primary">Enviados</p>
<p class="mt-2 text-3xl font-display text-gray-900" id="totalEnviados">0</p>
</article>
<article class="bg-white/95 border border-white/70 rounded-2xl shadow-soft p-4">
<p class="text-xs font-bold uppercase tracking-wide text-primary">Recebidos</p>
<p class="mt-2 text-3xl font-display text-gray-900" id="totalRecebidos">0</p>
</article>
</section>

<section class="grid grid-cols-1 lg:grid-cols-2 gap-5">
<article class="bg-white/95 border border-white/70 rounded-2xl shadow-soft p-4">
<h2 class="font-display text-primary text-2xl mb-3">Eu Enviei</h2>
<div class="space-y-3" id="sentList"></div>
</article>
<article class="bg-white/95 border border-white/70 rounded-2xl shadow-soft p-4">
<h2 class="font-display text-primary text-2xl mb-3">Eu Recebi</h2>
<div class="space-y-3" id="receivedList"></div>
</article>
</section>

<footer class="pb-8">
<p class="text-center text-xs font-bold uppercase tracking-widest text-gray-400">
Atualizado em <span class="text-primary" id="lastUpdate">--/--/---- --:--</span>
</p>
<p class="text-center text-[11px] font-semibold text-gray-400 mt-1" id="sourceInfo"></p>
</footer>
</main>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const sidebar = document.getElementById("sidebar");
    const toggleBtn = document.getElementById("sidebarToggle");
    const overlay = document.getElementById("sidebarOverlay");
    const mobileMenuBtn = document.getElementById("mobileMenuBtn");
    const smallLogo = document.querySelector(".sidebar-collapsed-only");
    const chevron = toggleBtn ? toggleBtn.querySelector("span") : null;
    if (!sidebar || !toggleBtn || !overlay || !mobileMenuBtn || !smallLogo || !chevron) return;
    function openSidebar() { sidebar.classList.add("expanded"); chevron.textContent = "chevron_left"; smallLogo.style.opacity = "0"; }
    function closeSidebar() {
      sidebar.classList.remove("expanded");
      chevron.textContent = "chevron_right";
      window.setTimeout(function () { if (!sidebar.classList.contains("expanded")) smallLogo.style.opacity = "1"; }, 220);
    }
    toggleBtn.addEventListener("click", function () { sidebar.classList.contains("expanded") ? closeSidebar() : openSidebar(); });
    mobileMenuBtn.addEventListener("click", openSidebar);
    overlay.addEventListener("click", closeSidebar);
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const monthSelect = document.getElementById("monthSelect");
    const refreshBtn = document.getElementById("refreshBtn");
    const refreshBtnLabel = document.getElementById("refreshBtnLabel");
    const totalMesEl = document.getElementById("totalMes");
    const totalEnviadosEl = document.getElementById("totalEnviados");
    const totalRecebidosEl = document.getElementById("totalRecebidos");
    const sentListEl = document.getElementById("sentList");
    const receivedListEl = document.getElementById("receivedList");
    const sourceInfoEl = document.getElementById("sourceInfo");
    const lastUpdateEl = document.getElementById("lastUpdate");
    let loading = false;

    function escapeHtml(value) {
      return String(value || "")
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#39;");
    }

    function setLoading(isLoading) {
      loading = isLoading;
      refreshBtn.disabled = isLoading;
      monthSelect.disabled = isLoading;
      refreshBtnLabel.textContent = isLoading ? "Carregando..." : "Atualizar";
    }

    function renderMonthOptions(months, selectedKey) {
      const sorted = Array.isArray(months) ? months : [];
      monthSelect.innerHTML = sorted.map(function (item) {
        const key = String(item && item.chave || "");
        const label = String(item && item.label || key);
        return '<option value="' + escapeHtml(key) + '">' + escapeHtml(label) + "</option>";
      }).join("");
      if (selectedKey) {
        monthSelect.value = selectedKey;
      }
    }

    function renderSummary(summary) {
      const safe = summary || {};
      totalMesEl.textContent = String(safe.total_registros || 0);
      totalEnviadosEl.textContent = String(safe.enviados || 0);
      totalRecebidosEl.textContent = String(safe.recebidos || 0);
    }

    function valuesBadges(values) {
      const safeValues = Array.isArray(values) ? values.filter(Boolean) : [];
      if (!safeValues.length) return '<span class="text-xs text-gray-400">Sem valores marcados</span>';
      return safeValues.map(function (value) {
        return '<span class="inline-flex items-center rounded-full border border-red-200 bg-red-50 text-red-700 px-2.5 py-1 text-[11px] font-bold">' + escapeHtml(value) + "</span>";
      }).join(" ");
    }

    function itemHtml(item, typeLabel) {
      const other = (item && item.outra_pessoa) || {};
      const files = (item && item.arquivos) || {};
      const dataLabel = [item.dia || "", item.horario || ""].filter(Boolean).join(" às ");
      const mediaUrl = String(files.uploaded_image_url || files.image_url || "").trim();
      const mensagem = String(item.mensagem || "").trim();
      return '' +
        '<div class="rounded-xl border border-gray-100 bg-gray-50/80 p-3.5">' +
          '<div class="flex items-start justify-between gap-2">' +
            '<div>' +
              '<p class="text-xs uppercase font-bold tracking-wide text-primary">' + escapeHtml(typeLabel) + '</p>' +
              '<p class="text-sm font-extrabold text-gray-900">' + escapeHtml(other.nome || "Sem nome") + '</p>' +
              '<p class="text-xs font-semibold text-gray-500">' + escapeHtml(other.funcao || "-") + '</p>' +
            '</div>' +
            '<span class="text-[11px] font-bold text-gray-500">' + escapeHtml(dataLabel || "-") + '</span>' +
          '</div>' +
          '<p class="mt-2 text-xs font-semibold text-gray-500">Telefone: <span class="text-gray-700">' + escapeHtml(other.numero || "-") + "</span></p>" +
          '<div class="mt-2 flex flex-wrap gap-1.5">' + valuesBadges(item.valores) + "</div>" +
          (mensagem ? '<p class="mt-2 text-xs text-gray-700"><strong>Mensagem:</strong> ' + escapeHtml(mensagem) + "</p>" : "") +
          (mediaUrl ? '<a class="mt-3 inline-flex text-xs font-bold text-primary hover:underline" href="' + escapeHtml(mediaUrl) + '" rel="noopener noreferrer" target="_blank">Abrir imagem do Super POP</a>' : "") +
        "</div>";
    }

    function renderItems(container, items, emptyText, label) {
      const safe = Array.isArray(items) ? items : [];
      if (!safe.length) {
        container.innerHTML = '<div class="rounded-xl border border-dashed border-gray-200 bg-gray-50 p-4 text-sm font-semibold text-gray-500">' + escapeHtml(emptyText) + "</div>";
        return;
      }
      container.innerHTML = safe.map(function (item) { return itemHtml(item, label); }).join("");
    }

    async function fetchData(monthKey) {
      let url = "/api/me/superpops";
      if (monthKey) {
        url += "?month=" + encodeURIComponent(monthKey);
      }
      const response = await fetch(url, { cache: "no-store" });
      const payload = await response.json().catch(function () { return {}; });
      if (!response.ok || !payload.ok) {
        throw new Error(String(payload.error || "Falha ao carregar seus Super POP's."));
      }
      return payload;
    }

    async function loadData(monthKey) {
      if (loading) return;
      setLoading(true);
      try {
        const payload = await fetchData(monthKey);
        renderMonthOptions(payload.meses_disponiveis, payload.mes_selecionado);
        renderSummary(payload.resumo_mes);
        renderItems(sentListEl, payload.enviados, "Nenhum Super POP enviado neste mês.", "Enviado para");
        renderItems(receivedListEl, payload.recebidos, "Nenhum Super POP recebido neste mês.", "Recebido de");
        const source = payload.fonte || {};
        sourceInfoEl.textContent = source.tipo === "remoto"
          ? "Fonte: remoto"
          : "Fonte: local" + (source.erro_remoto ? " (fallback)" : "");
      } catch (error) {
        const message = String(error && error.message ? error.message : "Erro ao carregar dados.");
        sentListEl.innerHTML = '<div class="rounded-xl border border-red-200 bg-red-50 p-4 text-sm font-bold text-red-700">' + escapeHtml(message) + "</div>";
        receivedListEl.innerHTML = sentListEl.innerHTML;
        if (/nao autenticado|sessao invalida/i.test(message)) {
          window.location.href = "index.html";
          return;
        }
      } finally {
        setLoading(false);
        const now = new Date();
        lastUpdateEl.textContent = now.toLocaleDateString("pt-BR") + " " + now.toLocaleTimeString("pt-BR", { hour: "2-digit", minute: "2-digit" });
      }
    }

    monthSelect.addEventListener("change", function () {
      loadData(monthSelect.value);
    });
    refreshBtn.addEventListener("click", function () {
      loadData(monthSelect.value);
    });

    loadData("");
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const authUserBtn = document.getElementById("authUserBtn");
    const authUserDropdown = document.getElementById("authUserDropdown");
    const authLogoutBtn = document.getElementById("authLogoutBtn");
    const nameTargets = [document.getElementById("authUserName"), document.getElementById("authUserNameDetail")];
    const roleTargets = [document.getElementById("authUserRole"), document.getElementById("authUserRoleDetail")];
    if (!authUserBtn || !authUserDropdown || !authLogoutBtn) return;

    function setUserView(nome, funcao) {
      const safeNome = String(nome || "").trim() || "Usuario";
      const safeFuncao = String(funcao || "").trim() || "Sem funcao";
      nameTargets.forEach(function (el) { if (el) el.textContent = safeNome; });
      roleTargets.forEach(function (el) { if (el) el.textContent = safeFuncao; });
    }

    async function loadUserFromSession() {
      const response = await fetch("/api/auth/me", { cache: "no-store" });
      if (!response.ok) throw new Error("Nao autenticado");
      const payload = await response.json();
      if (!payload || !payload.ok || !payload.usuario) throw new Error("Sessao invalida");
      setUserView(payload.usuario.nome, payload.usuario.funcao);
    }

    authUserBtn.addEventListener("click", function () {
      const isOpen = authUserDropdown.classList.contains("open");
      authUserDropdown.classList.toggle("open", !isOpen);
      authUserBtn.setAttribute("aria-expanded", String(!isOpen));
    });

    document.addEventListener("click", function (event) {
      if (!authUserDropdown.contains(event.target) && !authUserBtn.contains(event.target)) {
        authUserDropdown.classList.remove("open");
        authUserBtn.setAttribute("aria-expanded", "false");
      }
    });

    authLogoutBtn.addEventListener("click", async function () {
      try { await fetch("/api/auth/logout", { method: "POST" }); } catch (_err) {}
      try { localStorage.removeItem("superpop_auth_user"); } catch (_err) {}
      window.location.href = "index.html";
    });

    loadUserFromSession().catch(function () {
      window.location.href = "index.html";
    });
  });
</script>
</body></html>
